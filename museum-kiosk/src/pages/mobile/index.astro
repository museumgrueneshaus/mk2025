---
import MobileLayout from '../../layouts/MobileLayout.astro';
import { getCollection } from 'astro:content';

// Get featured content
const exhibits = await getCollection('exhibits', ({ data }) => data.featured);
const events = await getCollection('events', ({ data }) => {
  return data.published && !data.cancelled && new Date(data.date) >= new Date();
});

const todayEvents = events.filter(event => {
  const eventDate = new Date(event.data.date);
  const today = new Date();
  return eventDate.toDateString() === today.toDateString();
}).slice(0, 3);
---

<MobileLayout title="Museum Gr√ºnes Haus" activeTab="home">
  <div class="museum-app">
    <!-- Hero Section - MoMA Style -->
    <section class="hero-section">
      <div class="hero-content">
        <h1 class="museum-display hero-title">
          <span class="title-line">Museum</span>
          <span class="title-line accent">Gr√ºnes Haus</span>
        </h1>
        <p class="museum-caption hero-subtitle">Reutte ‚Ä¢ Tirol</p>
      </div>
      <div class="hero-visual">
        <div class="hero-image-container">
          <img 
            src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&q=80" 
            alt="Museum Collection" 
            class="hero-image ken-burns-subtle"
          />
          <div class="hero-overlay"></div>
        </div>
      </div>
    </section>

    <!-- Current Exhibition - Tate Modern Style -->
    <section class="current-exhibition">
      <div class="section-header">
        <h2 class="museum-heading section-title">Aktuelle Ausstellung</h2>
        <a href="/mobile/exhibits" class="link-arrow">
          <span>Alle ansehen</span>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      </div>
      
      <div class="exhibition-card museum-card">
        <div class="exhibition-image">
          <img 
            src="https://images.unsplash.com/photo-1577720643272-265f09367456?w=800&q=80" 
            alt="Meisterwerke der Moderne"
            class="ken-burns-subtle"
          />
          <div class="exhibition-badge">Noch 15 Tage</div>
        </div>
        <div class="exhibition-content">
          <span class="museum-caption exhibition-category">Sonderausstellung</span>
          <h3 class="museum-heading exhibition-title">Meisterwerke der Moderne</h3>
          <p class="museum-body exhibition-description">
            Eine faszinierende Reise durch die revolution√§ren Kunstbewegungen des 20. Jahrhunderts.
          </p>
          <button class="museum-button exhibition-cta">
            Tickets buchen
          </button>
        </div>
      </div>
    </section>

    <!-- Quick Navigation - Centre Pompidou Style -->
    <section class="quick-nav">
      <div class="nav-grid">
        <a href="/mobile/scan" class="nav-card glass-premium">
          <div class="nav-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M3 9V5a2 2 0 012-2h4M3 15v4a2 2 0 002 2h4M15 3h4a2 2 0 012 2v4M15 21h4a2 2 0 002-2v-4"/>
            </svg>
          </div>
          <span class="nav-label">QR Scanner</span>
        </a>
        
        <a href="/mobile/map" class="nav-card glass-premium">
          <div class="nav-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M3 7l6-3 6 3 6-3v13l-6 3-6-3-6 3V7z"/>
            </svg>
          </div>
          <span class="nav-label">Karte</span>
        </a>
        
        <a href="/mobile/tours" class="nav-card glass-premium">
          <div class="nav-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
          <span class="nav-label">Touren</span>
        </a>
        
        <a href="/mobile/info" class="nav-card glass-premium">
          <div class="nav-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 16v-4M12 8h.01"/>
            </svg>
          </div>
          <span class="nav-label">Info</span>
        </a>
      </div>
    </section>

    <!-- Today's Events - Pinakothek Style -->
    {todayEvents.length > 0 && (
      <section class="events-section">
        <div class="section-header">
          <h2 class="museum-heading section-title">Heute im Museum</h2>
          <a href="/mobile/events" class="link-arrow">
            <span>Alle Events</span>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          </a>
        </div>
        
        <div class="events-list">
          {todayEvents.map(event => (
            <a href={`/mobile/event/${event.slug}`} class="event-card">
              <div class="event-time">
                <span class="time-value">{event.data.time}</span>
                <span class="time-label">Uhr</span>
              </div>
              <div class="event-details">
                <span class="museum-caption event-category">{event.data.category}</span>
                <h4 class="event-title">{event.data.title}</h4>
                <p class="event-location">{event.data.location}</p>
              </div>
              <div class="event-arrow">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 18l6-6-6-6"/>
                </svg>
              </div>
            </a>
          ))}
        </div>
      </section>
    )}

    <!-- Featured Highlights - Guggenheim Style -->
    <section class="highlights-section">
      <div class="section-header">
        <h2 class="museum-heading section-title">Highlights der Sammlung</h2>
      </div>
      
      <div class="highlights-carousel scroll-snap-container">
        {exhibits.slice(0, 5).map((exhibit, index) => (
          <a 
            href={`/mobile/exhibit/${exhibit.slug}`} 
            class="highlight-card scroll-snap-item"
            style={`animation-delay: ${index * 0.1}s`}
          >
            <div class="highlight-image">
              <img 
                src={exhibit.data.thumbnail || exhibit.data.image} 
                alt={exhibit.data.title}
                loading="lazy"
              />
              <div class="highlight-number">
                <span>{String(index + 1).padStart(2, '0')}</span>
              </div>
            </div>
            <div class="highlight-content">
              <h3 class="museum-heading highlight-title">{exhibit.data.title}</h3>
              <p class="museum-caption highlight-artist">{exhibit.data.artist}</p>
              <p class="museum-caption highlight-year">{exhibit.data.year}</p>
            </div>
          </a>
        ))}
      </div>
    </section>

    <!-- Visit Info - Minimalist Design -->
    <section class="visit-section">
      <div class="visit-grid">
        <div class="visit-card">
          <span class="visit-icon">üïê</span>
          <div class="visit-content">
            <h4 class="museum-caption">√ñffnungszeiten</h4>
            <p class="visit-value">Di‚ÄìSa 13:00‚Äì17:00</p>
          </div>
        </div>
        
        <div class="visit-card">
          <span class="visit-icon">üìç</span>
          <div class="visit-content">
            <h4 class="museum-caption">Adresse</h4>
            <p class="visit-value">Untermarkt 25, Reutte</p>
          </div>
        </div>
        
        <div class="visit-card">
          <span class="visit-icon">üí∂</span>
          <div class="visit-content">
            <h4 class="museum-caption">Eintritt</h4>
            <p class="visit-value">Erw. ‚Ç¨5 / Erm. ‚Ç¨4</p>
          </div>
        </div>
      </div>
    </section>
  </div>
</MobileLayout>

<style>
  .museum-app {
    background: var(--museum-white);
    min-height: 100vh;
    animation: pageEnter 0.6s var(--ease-out-expo);
  }

  /* Hero Section */
  .hero-section {
    position: relative;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    overflow: hidden;
  }

  .hero-content {
    position: relative;
    z-index: 2;
    padding: var(--space-34) var(--space-21);
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .hero-title {
    font-size: var(--text-5xl);
    line-height: 0.85;
    margin-bottom: var(--space-13);
  }

  .title-line {
    display: block;
    animation: slideInFromLeft 0.8s var(--ease-out-expo) both;
  }

  .title-line.accent {
    color: var(--moma-red);
    animation-delay: 0.1s;
  }

  .hero-subtitle {
    opacity: 0.8;
    animation: fadeIn 1s var(--ease-out-expo) 0.3s both;
  }

  .hero-visual {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 40vh;
    z-index: 1;
  }

  .hero-image-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .hero-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to bottom,
      var(--museum-white) 0%,
      transparent 50%,
      rgba(0,0,0,0.3) 100%
    );
  }

  /* Current Exhibition */
  .current-exhibition {
    padding: var(--space-34) var(--space-21);
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-21);
  }

  .section-title {
    font-size: var(--text-2xl);
  }

  .link-arrow {
    display: flex;
    align-items: center;
    gap: var(--space-5);
    color: var(--museum-black);
    text-decoration: none;
    font-size: var(--text-sm);
    font-weight: 500;
    transition: all 0.3s var(--ease-out-expo);
  }

  .link-arrow:hover {
    gap: var(--space-8);
  }

  .exhibition-card {
    overflow: hidden;
  }

  .exhibition-image {
    position: relative;
    height: 250px;
    overflow: hidden;
  }

  .exhibition-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .exhibition-badge {
    position: absolute;
    top: var(--space-13);
    right: var(--space-13);
    padding: var(--space-5) var(--space-13);
    background: var(--moma-red);
    color: white;
    font-size: var(--text-xs);
    font-weight: 600;
    border-radius: var(--radius-full);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .exhibition-content {
    padding: var(--space-21);
  }

  .exhibition-category {
    color: var(--museum-gray-600);
    margin-bottom: var(--space-5);
    display: block;
  }

  .exhibition-title {
    font-size: var(--text-xl);
    margin-bottom: var(--space-8);
  }

  .exhibition-description {
    margin-bottom: var(--space-21);
    color: var(--museum-gray-700);
  }

  /* Quick Navigation */
  .quick-nav {
    padding: 0 var(--space-21) var(--space-34);
  }

  .nav-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-13);
  }

  .nav-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--space-21);
    aspect-ratio: 1;
    border-radius: var(--radius-xl);
    text-decoration: none;
    color: var(--museum-black);
    transition: all 0.3s var(--ease-out-expo);
    position: relative;
    overflow: hidden;
  }

  .nav-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
      circle at center,
      rgba(0,0,0,0.05) 0%,
      transparent 70%
    );
    opacity: 0;
    transition: opacity 0.3s var(--ease-out-expo);
  }

  .nav-card:hover::before,
  .nav-card:active::before {
    opacity: 1;
  }

  .nav-card:active {
    transform: scale(0.98);
  }

  .nav-icon {
    margin-bottom: var(--space-8);
  }

  .nav-label {
    font-size: var(--text-sm);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* Events Section */
  .events-section {
    padding: var(--space-34) var(--space-21);
    background: var(--museum-gray-100);
  }

  .events-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-13);
  }

  .event-card {
    display: flex;
    align-items: center;
    gap: var(--space-21);
    padding: var(--space-21);
    background: var(--museum-white);
    border-radius: var(--radius-lg);
    text-decoration: none;
    color: var(--museum-black);
    transition: all 0.3s var(--ease-out-expo);
  }

  .event-card:hover {
    transform: translateX(var(--space-5));
    box-shadow: var(--shadow-md);
  }

  .event-time {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 60px;
  }

  .time-value {
    font-size: var(--text-xl);
    font-weight: 700;
    line-height: 1;
  }

  .time-label {
    font-size: var(--text-xs);
    text-transform: uppercase;
    opacity: 0.6;
  }

  .event-details {
    flex: 1;
  }

  .event-category {
    display: block;
    margin-bottom: var(--space-3);
    color: var(--tate-turquoise);
  }

  .event-title {
    font-size: var(--text-base);
    font-weight: 600;
    margin-bottom: var(--space-3);
  }

  .event-location {
    font-size: var(--text-sm);
    color: var(--museum-gray-600);
  }

  .event-arrow {
    opacity: 0.3;
  }

  /* Highlights Carousel */
  .highlights-section {
    padding: var(--space-34) 0;
  }

  .highlights-section .section-header {
    padding: 0 var(--space-21);
  }

  .highlights-carousel {
    display: flex;
    gap: var(--space-13);
    overflow-x: auto;
    padding: 0 var(--space-21);
    -webkit-overflow-scrolling: touch;
  }

  .highlight-card {
    flex: 0 0 280px;
    text-decoration: none;
    color: var(--museum-black);
    animation: scaleIn 0.6s var(--ease-out-expo) both;
  }

  .highlight-image {
    position: relative;
    height: 350px;
    margin-bottom: var(--space-13);
    overflow: hidden;
    border-radius: var(--radius-lg);
  }

  .highlight-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.6s var(--ease-out-expo);
  }

  .highlight-card:hover .highlight-image img {
    transform: scale(1.05);
  }

  .highlight-number {
    position: absolute;
    top: var(--space-13);
    left: var(--space-13);
    width: 40px;
    height: 40px;
    background: var(--museum-white);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: var(--text-sm);
  }

  .highlight-content {
    padding: 0 var(--space-5);
  }

  .highlight-title {
    font-size: var(--text-lg);
    margin-bottom: var(--space-5);
    line-height: 1.2;
  }

  .highlight-artist,
  .highlight-year {
    color: var(--museum-gray-600);
  }

  /* Visit Section */
  .visit-section {
    padding: var(--space-34) var(--space-21) var(--space-55);
    border-top: 1px solid var(--museum-gray-200);
  }

  .visit-grid {
    display: grid;
    gap: var(--space-21);
  }

  .visit-card {
    display: flex;
    gap: var(--space-13);
    align-items: center;
  }

  .visit-icon {
    font-size: var(--text-2xl);
  }

  .visit-content h4 {
    margin-bottom: var(--space-3);
    color: var(--museum-gray-600);
  }

  .visit-value {
    font-size: var(--text-base);
    font-weight: 500;
  }

  /* Responsive */
  @media (min-width: 768px) {
    .nav-grid {
      grid-template-columns: repeat(4, 1fr);
    }
    
    .visit-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  /* Animations */
  @keyframes slideInFromLeft {
    from {
      transform: translateX(-30px);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes scaleIn {
    from {
      transform: scale(0.95);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
</style>